<!DOCTYPE html>
<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/jetbrains-mono@1.0.6/css/jetbrains-mono.min.css" rel="stylesheet">
<title>g0ubu1i的博客</title>
<meta charset="UTF-8">
<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="g0ubu1i">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">
<meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
<meta name="description" content="比赛时间 250322-250326 BenginnerREverseOverAndOver - Crypto直接丢进Cyberchef base64一直解密得到flag  EtTuCaesar - CryptoPicturePerfect - Forensics右键查看图片的属性后在详细信息中可以看到flag DigginDir - Forensics解压后估计flag存在某个目录下的文本文件中">
<meta property="og:type" content="article">
<meta property="og:title" content="2025.03.wolvctf-wp">
<meta property="og:url" content="http://blog.g0ubu1i.online/posts/baebdd08.html">
<meta property="og:site_name" content="g0ubu1i的博客">
<meta property="og:description" content="比赛时间 250322-250326 BenginnerREverseOverAndOver - Crypto直接丢进Cyberchef base64一直解密得到flag  EtTuCaesar - CryptoPicturePerfect - Forensics右键查看图片的属性后在详细信息中可以看到flag DigginDir - Forensics解压后估计flag存在某个目录下的文本文件中">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://img.goubuli.online/blog/20250324173200.png">
<meta property="og:image" content="http://img.goubuli.online/blog/20250324173239.png">
<meta property="og:image" content="http://img.goubuli.online/blog/20250324173104.png">
<meta property="og:image" content="http://img.goubuli.online/blog/20250324173128.png">
<meta property="og:image" content="http://img.goubuli.online/blog/20250324173146.png">
<meta property="article:published_time" content="2025-03-30T15:17:05.000Z">
<meta property="article:modified_time" content="2025-05-27T14:52:37.179Z">
<meta property="article:author" content="g0ubu1i">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://img.goubuli.online/blog/20250324173200.png">
<link rel="shortcut icon" href="https://q.qlogo.cn/headimg_dl?dst_uin=1738327323&spec=640&img_type=jpg#">

<link rel="stylesheet" href="/css/common.css">






  
<link rel="stylesheet" href="/css/post.css">

  <link rel="stylesheet" href="/css/highlight-dark.css" media="screen and (prefers-color-scheme: dark)">
  <link rel="stylesheet" href="/css/highlight-light.css" media="screen and (prefers-color-scheme: light)">
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
    });
  </script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>

    <meta name="generator" content="Hexo 6.3.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head>
    <body>
        <div class="post">
    <header class="breadcrumb">
        <a href="/" style="text-decoration: underline; font-style: italic;">Home</a>
        <span> / </span>
        <a style="text-decoration: underline; font-style: italic;" href="/posts/baebdd08.html">2025.03.wolvctf-wp</a>
    </header>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Benginner"><span class="toc-text">Benginner</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#REverse"><span class="toc-text">REverse</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OverAndOver-Crypto"><span class="toc-text">OverAndOver - Crypto</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EtTuCaesar-Crypto"><span class="toc-text">EtTuCaesar - Crypto</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PicturePerfect-Forensics"><span class="toc-text">PicturePerfect - Forensics</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DigginDir-Forensics"><span class="toc-text">DigginDir - Forensics</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#p0wn3d-Pwn"><span class="toc-text">p0wn3d - Pwn</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Forensics"><span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Passwords"><span class="toc-text">Passwords</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Active-1-Domain-Access"><span class="toc-text">Active 1: Domain Access</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AE%B5"><span class="toc-text">第一段</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Eval-is-Evil"><span class="toc-text">Eval is Evil</span></a></li></ol></li></ol>
    <div class="post-body">
        <h1 class="post-title">2025.03.wolvctf-wp</h1>
        <div class="post-meta">
            2025-2-30
            <span> · </span>
            
        </div>
        <div class="post-content"><p>比赛时间 250322-250326</p>
<h1 id="Benginner"><a href="#Benginner" class="headerlink" title="Benginner"></a>Benginner</h1><h2 id="REverse"><a href="#REverse" class="headerlink" title="REverse"></a>REverse</h2><h2 id="OverAndOver-Crypto"><a href="#OverAndOver-Crypto" class="headerlink" title="OverAndOver - Crypto"></a>OverAndOver - Crypto</h2><p>直接丢进Cyberchef base64一直解密得到flag <img src="http://img.goubuli.online/blog/20250324173200.png" alt="Pasted image 20250323215004.png"></p>
<h2 id="EtTuCaesar-Crypto"><a href="#EtTuCaesar-Crypto" class="headerlink" title="EtTuCaesar - Crypto"></a>EtTuCaesar - Crypto</h2><h2 id="PicturePerfect-Forensics"><a href="#PicturePerfect-Forensics" class="headerlink" title="PicturePerfect - Forensics"></a>PicturePerfect - Forensics</h2><p>右键查看图片的属性后在详细信息中可以看到flag</p>
<h2 id="DigginDir-Forensics"><a href="#DigginDir-Forensics" class="headerlink" title="DigginDir - Forensics"></a>DigginDir - Forensics</h2><p>解压后估计flag存在某个目录下的文本文件中，使用windows的findstr命令查找flag的开头wctf <code>findstr /s &quot;wctf&quot; *</code> <img src="http://img.goubuli.online/blog/20250324173239.png" alt="Pasted image 20250323223019.png"></p>
<h2 id="p0wn3d-Pwn"><a href="#p0wn3d-Pwn" class="headerlink" title="p0wn3d - Pwn"></a>p0wn3d - Pwn</h2><p>题目代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">struct __attribute__((__packed__)) data &#123;</span><br><span class="line">  char buf[32];</span><br><span class="line">  int guard;</span><br><span class="line">&#125;;</span><br><span class="line">void ignore(void)</span><br><span class="line">&#123;</span><br><span class="line">  setvbuf(stdout, NULL, _IONBF, 0);</span><br><span class="line">  setvbuf(stdin, NULL, _IONBF, 0);</span><br><span class="line">&#125;</span><br><span class="line">void get_flag(void)</span><br><span class="line">&#123;</span><br><span class="line">  char flag[1024] = &#123; 0 &#125;;</span><br><span class="line">  FILE *fp = fopen(&quot;flag.txt&quot;, &quot;r&quot;);</span><br><span class="line">  fgets(flag, 1023, fp);</span><br><span class="line">  printf(flag);</span><br><span class="line">&#125;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">  struct data first_words;</span><br><span class="line">  ignore(); /* ignore this function */</span><br><span class="line">  printf(&quot;Hello little p0wn3r. Do you have any first words?\n&quot;);</span><br><span class="line">  fgets(first_words.buf, 64, stdin);</span><br><span class="line">  sleep(2);</span><br><span class="line">  puts(&quot;Man that is so cute&quot;);</span><br><span class="line">  sleep(2);</span><br><span class="line">  puts(&quot;I remember last year people were screaming at the little p0wn3rs.. like AAAAAAAAAAAAAAAAAAAAAAAAAAAAA!&quot;);</span><br><span class="line">  sleep(2);</span><br><span class="line">  puts(&quot;Don&#x27;t worry little one. I won&#x27;t let them do that to you. I&#x27;ve set up a guard&quot;);</span><br><span class="line">  if (first_words.guard == 0x42424242) &#123;</span><br><span class="line">    get_flag();</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>代码中，定义了一个结构体，前32位为buf，后面为guard，而在main函数中，由于给buf赋值时限制大小为，所以在给buf赋值32字节的A之后，加上4字节的B，会使多余的数据溢出至guard</p>
<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="Passwords"><a href="#Passwords" class="headerlink" title="Passwords"></a>Passwords</h2><p>下载到.kdbx文件，搜索后为KeePass的数据文件，遂使用<code>keepass2john Database.kdbx &gt;&gt; hash.txt</code> 得到keepass密码的hash <img src="http://img.goubuli.online/blog/20250324173104.png" alt="Pasted image 20250323210647.png"> 再使用hashcat进行爆破（需要将前面的”Database：”删去） <code>hashcat -m 13400 hash.txt -a 0 rockyou.txt</code> 得到密码为： <img src="http://img.goubuli.online/blog/20250324173128.png" alt="Pasted image 20250323211019.png"> 随后拿密码进入keepass中翻找一番即可得到flag</p>
<h2 id="Active-1-Domain-Access"><a href="#Active-1-Domain-Access" class="headerlink" title="Active 1: Domain Access"></a>Active 1: Domain Access</h2><h3 id="第一段"><a href="#第一段" class="headerlink" title="第一段"></a>第一段</h3><p>dan用户的桌面上有木马文件以及一些输出文件，asreproast的输出中有第一段flag，还找到了emily用户密码的hash</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Eval-is-Evil"><a href="#Eval-is-Evil" class="headerlink" title="Eval is Evil"></a>Eval is Evil</h2><p>题目如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import random</span><br><span class="line">def main():</span><br><span class="line">    print(&quot;Let&#x27;s play a game, I am thinking of a number between 0 and&quot;, 2 ** 64, &quot;\n&quot;)</span><br><span class="line">    try:</span><br><span class="line">        guess = eval(input(&quot;What is the number?: &quot;))</span><br><span class="line">    except:</span><br><span class="line">        guess = 0</span><br><span class="line">    correct = random.randint(0, 2**64)</span><br><span class="line">    if (guess == correct):</span><br><span class="line">        print(&quot;\nCorrect! You won the flag!&quot;)</span><br><span class="line">        flag = open(&quot;flag.txt&quot;, &quot;r&quot;).readline()</span><br><span class="line">        print(flag)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;\nYou lost lol&quot;)</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p>发现是没有进行过滤的pyjail，直接<code>__import__(&quot;os&quot;).system(&quot;cat flag.txt&quot;)</code>秒了 <img src="http://img.goubuli.online/blog/20250324173146.png" alt="Pasted image 20250323213334.png"></p>
</div>
        <div class="divider"></div>
        <div class="license">
    <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/" style="text-decoration: none;">
        <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" />
    </a>
    <br/>
    This work is licensed under a 
    <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
</div>
    </div>
    <div id="gitalk-container"></div>
    <script>
        const gitalk = new Gitalk({
          clientID: '',
          clientSecret: '',
          repo: '',
          owner: '',
          admin: [''],
          id: location.pathname,
          distractionFreeMode: false
        })
    
        gitalk.render('gitalk-container')
    </script>
</div>
        <footer class="footer">Powered By <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> With Theme <a target="_blank" rel="noopener" href="https://github.com/EvanLuo42/oliver">Oliver</a></footer>
        <footer class="footer">copyright</footer>
    </body>
</html>