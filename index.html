<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>g0ubu1i的博客</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="g0ubu1i的博客"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="g0ubu1i的博客"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="website"><meta property="og:title" content="g0ubu1i的博客"><meta property="og:url" content="http://blog.g0ubu1i.online/"><meta property="og:site_name" content="g0ubu1i的博客"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://blog.g0ubu1i.online/img/og_image.png"><meta property="article:author" content="g0ubu1i"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://blog.g0ubu1i.online/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.g0ubu1i.online"},"headline":"g0ubu1i的博客","image":["http://blog.g0ubu1i.online/img/og_image.png"],"author":{"@type":"Person","name":"g0ubu1i"},"publisher":{"@type":"Organization","name":"g0ubu1i的博客","logo":{"@type":"ImageObject"}},"description":""}</script><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">g0ubu1i的博客</a></div><div class="navbar-menu"><div class="navbar-end"></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-12"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-11-01T09:02:11.000Z" title="2025/11/1 17:02:11">2025-11-01</time>发表</span><span class="level-item"><time dateTime="2025-11-01T09:03:10.174Z" title="2025/11/1 17:03:10">2025-11-01</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Writeup/">Writeup</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/9c5c8488.html">2025.11.数证杯</a></p><div class="content"><p>容器密码：<code>GQ7aXryvOC*M8qG*eXa19K9*g&amp;jtHS*Gtrimps@Qx*aYt4oRwwK*HeN0A$#EPv*u</code></p>
<h2 id="服务器取证">服务器取证</h2>
<p>1、node1节点的磁盘设备SHA256值前六位是？(字母全大写，答案格式：AAAAAA)<br>
2、集群配置了多少个node节点？（答案格式：1）<br>
3、嫌疑人于什么时间修改master节点的root密码？（使用双位数格式，答案格式：00:00:00）<br>
4、Docker的安装日期是？（使用双位数格式，答案格式：01月01日）<br>
5、Docker通过配置守护进程以使用全局代理，该代理地址的端口是？（答案格式：1）<br>
6、发卡网站使用的Mysql数据库对外访问端口是？（答案格式：1）<br>
7、发卡网站部署使用的镜像名称是？（答案格式：root/root）<br>
8、当前Telegram群管机器人使用的容器ID的前六位是？（答案格式：123abc）<br>
9、发卡网站使用的缓存数据库是？（答案格式：mysql）<br>
10、集群中配置的发卡网站代码运行所在的物理目录是？（答案格式：/root/root）<br>
11、Telegram群管机器人配置的API代理域名是？（答案格式：<a target="_blank" rel="noopener" href="http://www.xxx.com">www.xxx.com</a>）<br>
12、嫌疑人在Telegram上创建的群名称是？（答案格式：比武群）<br>
13、统计嫌疑人在Telegram上创建的群中2025年6月之后成功入群的人数为？（答案格式：1）<br>
14、据嫌疑人交代曾在发卡网上删除过一条订单数据，请找出该删除订单的订单号是？（答案格式：请按实际值填写）<br>
15、发卡网站上2025年6月之后订单交易成功的总金额是？忽略被删除的数据（答案格式：1）<br>
16、发卡网站的后台访问路径是？（答案格式：/root）<br>
17、计算出用户密码算法中Salt的值，并进行Base64编码，结果是？（答案格式：请按实际值填写）<br>
18、发卡网站配置的邮件发送人地址是？（答案格式：abc@abc.com）<br>
19、当前发卡网站首页仪表盘中显示的发卡网站版本为？（答案格式：1.1.1）<br>
20、当前发卡网站中绑定的订单推送Telegram用户id为（答案格式：请按实际值填写）</p>
<h2 id="流量包分析">流量包分析</h2>
<p>21、黑客攻击的目标路由器SSID为 （答案格式：请按实际值填写）<br>
22、黑客成功捕获了WIFI中WPA协议握手包，其中有效握手包组数为(完整握手为一组)（答案格式：1）<br>
23、黑客爆破得出的WiFi密码为（提示：密码由小写英文字母和数字组成）（答案格式：abcd1234）<br>
24、黑客成功连接Wifi后，发现路由器操作系统为？（答案格式：请按实际值填写）<br>
25、黑客对路由器后台进行爆破攻击，该路由器后台密码为（答案格式：请按实际值填写）<br>
26、黑客通过修改路由器设置，将被劫持的域名为（答案格式：<a target="_blank" rel="noopener" href="http://www.xxx.com">www.xxx.com</a>）<br>
27、黑客在路由器管理后台发现FTP服务配置，FTP登录密码为？（答案格式：请按实际值填写）<br>
28、黑客通过FTP上传了一个压缩包文件，该文件内容为（答案格式：请按实际值填写）<br>
29、黑客通过路由器执行shell脚本，反弹shell的监听端口为（答案格式：1）<br>
30、黑客通过反弹shell成功控制目标路由器后，总共执行了多少条命令（答案格式：1)</p>
<h2 id="apk程序分析">APK程序分析</h2>
<p>31、apk 的版本名称为？ （答案格式：1.1.1）<br>
32、在该APP中，调用了哪个System的方法用于获取本地系统的时间戳？（答案格式：MainActivity）<br>
33、apk运行后getVer()的返回值是多少？（答案格式：1.0.0）<br>
34、apk运行后需要通过一个http get请求才能打开第二个界面，给出该请求URL？ （答案格式：<a target="_blank" rel="noopener" href="http://www.xxx.com/test?a=1%EF%BC%89">http://www.xxx.com/test?a=1）</a><br>
35、apk第二界面的8位授权码是什么？ （答案格式：11111111）</p>
<h2 id="二进制程序分析">二进制程序分析</h2>
<p>36、安装该程序后，该恶意程序的可执行文件所在的直接父目录名称是什么为？（答案格式：root）<br>
37、解密文件名为RnRGaWxlcy5lZGIiL的文件时所使用的key是什么？（答案格式：请按实际值填写）<br>
38、解密文件RnRGaWxlcy5lZGIiL成功后，请分析并给出解密后的文件的入口点地址？（答案格式：0x180000000）<br>
39、加密文件名为6c051a72b91a1的文件时所使用的密钥是多少？（答案格式：请按实际值填写）<br>
40、6c051a72b91a1.1文件解密后的md5值后六位是多少？（字母全大写，答案格式：AAAAAA）</p>
<h2 id="计算机取证">计算机取证</h2>
<h3 id="41-操作系统的build版本号是？-答案格式：1">41、操作系统的Build版本号是？（答案格式：1）</h3>
<p>通过美亚超级取证大师，查看系统信息，答案为19044</p>
<h3 id="42-操作系统设置的账户密码最长存留期为多少天？-答案格式：1">42、操作系统设置的账户密码最长存留期为多少天？（答案格式：1）</h3>
<p>查看账户策略中的密码策略，最长留存期为68天</p>
<h3 id="43-用户2登陆密码nt哈希值后六位是？-字母全大写-答案格式：aaaaaa">43、用户2登陆密码NT哈希值后六位是？（字母全大写，答案格式：AAAAAA）</h3>
<p>通过用户信息，查看到NT哈希值为<code>d378c73f7c984db6f732499abea9c708</code></p>
<h3 id="44-蓝牙mac地址是多少？-答案格式：aa-aa-aa-aa-aa-aa">44、蓝牙mac地址是多少？（答案格式：AA-AA-AA-AA-AA-AA）</h3>
<p>查看网络连接，蓝牙连接的mac地址为<code>9c-b6-d0-04-c9-cc</code></p>
<h3 id="45-safeimager的产品序列号后四位是？-字母全大写-答案格式：aaaaaa">45、SafeImager的产品序列号后四位是？（字母全大写，答案格式：AAAAAA)</h3>
<p>仿真之后安装everything，搜索<code>SafeImager</code>,找到路径<code>C:\Users\Administrator\AppData\Roaming\SafeImager</code></p>
<p>46、123.VHD所处的结束扇区是？（答案格式：1 ）</p>
<h3 id="47-用户在bitlocker加密分区最后修改的文件是-答案格式：abcd-txt">47、用户在BitLocker加密分区最后修改的文件是?（答案格式：abcd.txt）</h3>
<p>挂载<code>C:\Users\Administrator\Documents\123.VHD</code>后，在backup文件夹中可以发现bitlocker的恢复密钥<code>625075-617309-532576-720302-040975-309232-451924-426679</code><br>
解锁D盘后可以按照修改日期排序，看到最后修改的文件为<code>资料1.txt</code></p>
<h3 id="48-用户连接192-168-114-129时用的会话名称是？-答案格式：按照实际情况填写">48、用户连接192.168.114.129时用的会话名称是？（答案格式：按照实际情况填写）</h3>
<p>打开Xshell，看到会话名称为<code>连接阿里云</code><br>
49、用户创建存储虚拟币钱包地址页面的时间是？（使用双位数格式，答案格式：01月01日）<br>
50、用户的虚拟币钱包地址是？（答案格式：按照实际情况填写）</p>
<h3 id="51-用户vc加密容器的密码是？-答案格式：按照实际情况填写">51、用户VC加密容器的密码是？（答案格式：按照实际情况填写）</h3>
<p>打开桌面的foxmail，可以看到SZB出题的邮件，其中有几个压缩包以及解压密码<code>258369</code><br>
保存1，2，3压缩包后发现依旧缺失文件，使用everything搜索<code>软件</code>后，找到4，5压缩包，成功解压，其中发现联系人.docx，拖到最后发现有白色的文字内容<code>VC密码：SHUZHENGBEIctzy2025</code></p>
<h3 id="52-用户在生活中使用的代号是？-答案格式：按照实际情况填写">52、用户在生活中使用的代号是？（答案格式：按照实际情况填写）</h3>
<p>将桌面上的代号.wav拖进Audacity，查看频谱图发现代码<code>小胖</code></p>
<h3 id="53-李安东的银行卡归属哪个银行？-答案格式：农业银行">53、李安东的银行卡归属哪个银行？（答案格式：农业银行）</h3>
<p>桌面的公司资料文件夹中有一个<code>银行卡6位纯数字.xlsx</code>文件，是由<code>office2john</code>导出hash后，是由<code>hashcat</code>爆破得到密码为<code>688561</code><br>
54、请分析某市10月6日最高气温是？（答案格式：1）</p>
<h3 id="55-用户的bitlocker密码是？-答案格式：按照实际情况填写">55、用户的BitLocker密码是？（答案格式：按照实际情况填写）</h3>
<p>依据47题目</p>
<h3 id="56-用户办公室的门禁密码是？-答案格式：按照实际情况填写">56、用户办公室的门禁密码是？（答案格式：按照实际情况填写）</h3>
<p>我们在51题拿到了vc的密码，而123.VHD文件中有<code>secretNew</code>文件，大小为25600kb。所以使用VC挂载该文件，发现其中有<code>办公室密码锁.jpg.enc</code>。我们在51题的压缩包中得到了<code>DecryptionTool.exe</code>，发现解密后可以得到解密后的图片。用010打开后发现结尾写着<code>147963258</code></p>
<h3 id="57-用户使用的以d开头的解密程序的md5值后六位是？-字母全大写-答案格式：aaaaaa">57、用户使用的以D开头的解密程序的MD5值后六位是？（字母全大写，答案格式：AAAAAA）</h3>
<p>计算56题中的exe的md5<br>
58、木马程序运行至系统断点前加载了几个动态链接库？（答案格式：1）<br>
59、木马产生的程序名称是什么？（答案格式：abcd.txt）<br>
60、木马尝试访问的域名是什么？（答案格式：按照实际情况填写）</p>
<h3 id="61-分析计算机内存检材-此内存镜像制作时的系统时间是？-使用双位数格式-答案格式：01月01日">61、分析计算机内存检材，此内存镜像制作时的系统时间是？（使用双位数格式，答案格式：01月01日）</h3>
<p>使用vol进行分析<code>python vol.py -f 内存检材.mem windows.info</code><br>
查看到<code>SystemTime      2025-10-16 11:21:53+00:00</code><br>
62、分析计算机内存检材，用户Yiyelin的用户表示后4位是？（答案格式：1111）<br>
63、分析计算机内存检材，计算机的CPU型号是什么？（答案格式： i9-1110U）</p>
<h3 id="64-分析计算机内存检材-wps-exe的pid是？-答案格式：1">64、分析计算机内存检材，wps.exe的PID是？（答案格式：1）</h3>
<p>使用vol进行分析 <code>python vol.py -f 内存检材.mem windows.pslist</code><br>
查看到<code>5888    5876    wps.exe 0xb302c112d800 </code><br>
65、分析计算机内存检材，此计算机开机自启动的远控软件名称是？（答案格式：abcd.txt）</p>
<h2 id="物联网设备取证">物联网设备取证</h2>
<h3 id="66-打印机的主机名称是什么？-答案格式：root">66、打印机的主机名称是什么？(答案格式：root)</h3>
<p>美亚超级取证大师加载后，查看到主机名为<code>print</code><br>
67、打印文件存储在哪个目录？(答案格式：/root/root)</p>
<h3 id="68-同一天-打印两份文件的用户是谁？-答案格式：root">68、同一天，打印两份文件的用户是谁？(答案格式：root)</h3>
<p>进入终端，在<code>\var\log\cups</code>中可以找到<code>page_log</code>文件，其中记录了alice打印了两次<br>
69、分析物联网检材，木马运行后，自身产生的进程ID是多少？（答案格式：1）<br>
70、分析物联网检材，系统中存在一个非标定时任务，这个任务每隔多少分钟执行？（答案格式：1）<br>
71、分析物联网检材，木马程序会窃取文档暂存在隐藏目录，这个目录的绝对路径？（/root/root/）<br>
72、分析物联网检材，木马程序将数据上传到的服务器的IP地址是多少？（答案格式：1.1.1.1）<br>
73、根据木马程序，它监视的关键字是什么？（答案格式：按照实际情况填写）</p>
<h2 id="移动终端取证">移动终端取证</h2>
<h3 id="74-分析检材中微信id-wxid-f4s0jmpvrc522对应的手机号后四位为-答案格式：1111">74、分析检材中微信ID:wxid_f4s0jmpvrc522对应的手机号后四位为（答案格式：1111）</h3>
<p>使用取证大师加载，查看到手机号为<code>17859628390</code></p>
<h3 id="75-分析检材中-华为应用市场-第一次安装日期为-使用双位数格式-答案格式：01月01日">75、分析检材中“华为应用市场”第一次安装日期为（使用双位数格式，答案格式：01月01日）</h3>
<p>使用取证大师查看应用使用记录，可以看到安装时间为<code>2025-09-24 19:37:42</code></p>
<h3 id="76-找出检材中钱包app-请列出该app中eth地址后六位是-字母全大写-答案格式：aaaaaa">76、找出检材中钱包APP，请列出该APP中ETH地址后六位是（字母全大写，答案格式：AAAAAA）</h3>
<p>取证大师分析到<code>imToken</code>软件，其中ETH的地址为<code>0x304fEd2927f47692E50158A1148a1B65503FE61F</code></p>
<h3 id="77-分析出检材中包含-南昌西站-的图片-计算该图片的md5后六位？-字母全大写-答案格式：aaaaaa">77、分析出检材中包含“南昌西站”的图片，计算该图片的MD5后六位？（字母全大写，答案格式：AAAAAA）</h3>
<p>在图片中硬找找到文件<br>
<code>MD5 的 IMG_0092.JPG.jfif 哈希: </code>25def5e31002f14894adef17d585a51d<code> </code>CertUtil: -hashfile 命令成功完成。`</p>
<h3 id="78-手机相册中有张-imtoken助记词1-png-图片被破坏-请修复该图片-列出该图片中第三个单词-答案格式：按照实际情况填写">78、手机相册中有张“imtoken助记词1.PNG”图片被破坏，请修复该图片，列出该图片中第三个单词。（答案格式：按照实际情况填写）</h3>
<p>已经知道了图片的名字，直接拿everything搜，拿到图片后放到<code>PuzzleSolver</code>修复宽高，得到正常的图片。</p>
<h3 id="79-找出一张png图片-该图片上显示-助记词2-请列出该图片上显示的第二个单词-答案格式：按照实际情况填写">79、找出一张PNG图片，该图片上显示“助记词2”，请列出该图片上显示的第二个单词。（答案格式：按照实际情况填写）</h3>
<p>在everything直接搜索<code>.png</code>，找到名为<code>imtoken助记词2_2.PNG</code>的图片</p>
<h3 id="80-找出检材中显示-助记词3-的文档-列出该文档中记录的第三个助记词单词-答案格式：按照实际情况填写">80、找出检材中显示“助记词3”的文档，列出该文档中记录的第三个助记词单词。（答案格式：按照实际情况填写）</h3>
<p>已经说明是文档，但是搜索docx,doc都没有找到相关的文件，找到一个名为<code>备忘录</code>的无后缀文件。文件头是pk开头，修改后缀名<code>.docx</code>打开后并没有看到助记词，使用010打开文件，发现助记词在末尾<br>
81、分析出该组助记词正常顺序中最后一个单词（已知助记词1、助记词2、助记词3中的单词顺序有被调整）。（答案格式：按照实际情况填写）<br>
82、分析出邮箱中收件人QQ号为“850563586”的姓名（答案格式：按照实际情况填写）</p>
<h3 id="83-得知机主通过某个应用给hhshal发送了一个文档-该应用的数据包名是什么？-答案格式：com-test">83、得知机主通过某个应用给HHshAL发送了一个文档，该应用的数据包名是什么？（答案格式：com.test）</h3>
<p>通过分析出的包名搜索相关的应用，只有<code>dingtong.saichuang</code>可以进行即时通讯<br>
84、接上题，该应用聊天记录数据库的打开密码是什么？（答案格式：按照实际情况填写）<br>
85、接上题，机主发送的这个加密文档，打开密码是什么？（答案格式：按照实际情况填写）<br>
86、厉明的身份证地址登记的门牌号是多少？？（答案格式：1）<br>
87、分析出“important1.xlsx”文件中体现的“金达欣”银行卡后六位？（答案格式：111111）<br>
88、接上题，保存“important1.xlsx”打开密码数据的应用，该应用的启动密码是什么？（答案格式：按照实际情况填写）</p>
<h2 id="数据分析">数据分析</h2>
<p>90、通过对检材“01-lott.sql”文件进行分析，统计t_trade_betrecord中庄家&quot;188&quot;记录中彩票类型为&quot;jnd28&quot;且期号在t_lottery_jnd表中存在的记录数。（答案格式：1）<br>
91、通过对检材“01-lott.sql”文件进行分析，统计庄家&quot;188&quot;的玩家在2021-05-10当日：电子投注内容出现频率最高的电子投注内容是什么？（答案格式：按照实际情况填写）<br>
92、通过对检材“01-lott.sql”文件进行分析，关联t_trade_betrecord与t_lottery_jnd表，分析庄家&quot;188&quot;在2021-05-10投注&quot;jnd28&quot;时：当开奖结果为&quot;大&quot;时，玩家投注包含&quot;小&quot;的笔数占比（使用双位数格式，答案格式：11.11%）<br>
93、通过对检材“02-crime_records.sql”分析，统计相邻两次作案时间间隔在1天之内的城市和该城市两次作案时间间隔在1天之内的案件总数量，找出案件总数最多的城市名。（答案格式：按照实际情况填写）<br>
94、通过对检材“02-crime_records.sql”分析，根据案件的损失金额和伤情等级，将案件分为 “轻微案件”“一般案件”“重大案件”“其他”四类（分类规则如下），并统计 2023 年各类型案件的数量。轻微案件：损失金额≤10000 元且无人员受伤（injury_level 为空或未提及）；一般案件：损失金额 10001-50000 元，或有轻微伤；重大案件：损失金额 &gt; 50000 元，或有轻伤或有重伤；其他：非上述情况。（按照案件数量的降序输出答案，答案格式为：40/30/20/10）<br>
95、通过对检材“02-crime_records.sql”分析，统计 2021-2023 年期间（含2021年和2023年），每年处理结果为 “移送起诉” 的案件里，每一年中损失总额最高的案件类型对应的损失总额为？（按 2021 - 2023 年顺序连接损失总额，连接符号使用/,小数点保留2位，答案格式为 ：1.37/2.21/3.45）<br>
96、通过对检材“03-案件卡串号数据”表分析，该表每条数据的“卡串号(IMSI)”字段值存在问题，不可信。真实可信的卡串号值在“溯源”字段中（溯源字段的值格式均为“{手机号=[待获取的卡串号-&gt;手机卡串号(IMSI)使用过的手机号-&gt;当前]}”），请统计分析出该表中哪个真实卡串号出现过的次数最多？（答案格式：按照实际情况填写）<br>
97、通过对检材“04-涉诈案件信息表“分析，统计每个分局2024-2025年每月被骗总额环比大于30%的月份个数（环比定义：（这个月的数据-上个月的数据）/上个月数据。特殊情况，例如某分局2025年1月被骗金额总和为100，若该分局2024年12月没有被骗金额，则该分局2025年1月也符合题目要求，应增加一个月份。2024年1月不需要计算与上个月的环比情况），请写出环比大于30%的月份个数最多的分局ID名称为？（答案格式：按照实际情况填写）<br>
98、通过对检材“05-人像卡口信息表”和“06-涉毒前科人员信息表”（两表均无重复数据，直接要求答题即可。感知时间字段格式均为yyyy-MM-dd HH:mm:ss；传感器ID（人像卡口点位）值不同则代表不同的摄像点位），为摸排疑似涉毒的窝点，请分析出在00:00:00~06:00:00(含0点跟6点)人像记录中，哪个传感器点位ID抓拍到最多的不同涉毒前科人员？（答案格式：按照实际情况填写）<br>
99、接上题，为摸排潜在的涉毒人员，请分析出有多少个非涉毒前科人员至少跟3个不同的涉毒前科人员同行过？（本题的“同行”指：两人在同一个人像卡口点位感知时间差在10（含）秒内）（答案格式：1）<br>
100、近几年架设简易GOIP设备进行群呼诈骗的案件屡见不鲜。架设和维护该设备的人员通常会频繁更换酒店【即只住一天然后更换酒店】以此躲避公安的侦察打击。请根据”07-旅店住宿信息表“（该表无重复数据，直接要求答题即可。时间相关的字段格式均为yyyy-MM-dd HH:mm:ss），筛选出2024和2025年的住宿记录（以“入住时间”为准），频繁更换酒店的人员有几个？（答案格式：1）</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-06-02T14:16:24.000Z" title="2025/6/2 22:16:24">2025-06-02</time>发表</span><span class="level-item"><time dateTime="2025-06-02T14:43:25.042Z" title="2025/6/2 22:43:25">2025-06-02</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%99%E7%A8%8B/">教程</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/13b80eda.html">obsidian搭配坚果云实现知识库备份同步</a></p><div class="content"><h1 id="准备阶段"><a href="#准备阶段" class="headerlink" title="准备阶段"></a>准备阶段</h1><p>准备好坚果云账户以及下载好obsidian</p>
<p>坚果云网站：<a target="_blank" rel="noopener" href="https://www.jianguoyun.com/">https://www.jianguoyun.com/</a></p>
<p>obsidian：<a target="_blank" rel="noopener" href="https://obsidian.md/">https://obsidian.md/</a></p>
<h1 id="obsidian插件下载"><a href="#obsidian插件下载" class="headerlink" title="obsidian插件下载"></a>obsidian插件下载</h1><p>在obsidian设置中，找到第三方插件，下载remotely save</p>
<p><img src="http://img.goubuli.online/blog/20250602222254.png" alt="image-20250602222245470"></p>
<h1 id="坚果云设置"><a href="#坚果云设置" class="headerlink" title="坚果云设置"></a>坚果云设置</h1><p>在账号信息-&gt;安全选项中选择添加应用，设置好名称后，牢记接下来的密码</p>
<p>随后在obsidian的remotely save中选择远程服务为webdav，服务器地址等信息按照坚果云上的信息填写</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-03-30T15:17:05.000Z" title="2025/3/30 23:17:05">2025-03-30</time>发表</span><span class="level-item"><time dateTime="2025-05-27T14:52:37.179Z" title="2025/5/27 22:52:37">2025-05-27</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Writeup/">Writeup</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/baebdd08.html">2025.03.wolvctf-wp</a></p><div class="content"><p>比赛时间 250322-250326</p>
<h1 id="Benginner"><a href="#Benginner" class="headerlink" title="Benginner"></a>Benginner</h1><h2 id="REverse"><a href="#REverse" class="headerlink" title="REverse"></a>REverse</h2><h2 id="OverAndOver-Crypto"><a href="#OverAndOver-Crypto" class="headerlink" title="OverAndOver - Crypto"></a>OverAndOver - Crypto</h2><p>直接丢进Cyberchef base64一直解密得到flag <img src="http://img.goubuli.online/blog/20250324173200.png" alt="Pasted image 20250323215004.png"></p>
<h2 id="EtTuCaesar-Crypto"><a href="#EtTuCaesar-Crypto" class="headerlink" title="EtTuCaesar - Crypto"></a>EtTuCaesar - Crypto</h2><h2 id="PicturePerfect-Forensics"><a href="#PicturePerfect-Forensics" class="headerlink" title="PicturePerfect - Forensics"></a>PicturePerfect - Forensics</h2><p>右键查看图片的属性后在详细信息中可以看到flag</p>
<h2 id="DigginDir-Forensics"><a href="#DigginDir-Forensics" class="headerlink" title="DigginDir - Forensics"></a>DigginDir - Forensics</h2><p>解压后估计flag存在某个目录下的文本文件中，使用windows的findstr命令查找flag的开头wctf <code>findstr /s &quot;wctf&quot; *</code> <img src="http://img.goubuli.online/blog/20250324173239.png" alt="Pasted image 20250323223019.png"></p>
<h2 id="p0wn3d-Pwn"><a href="#p0wn3d-Pwn" class="headerlink" title="p0wn3d - Pwn"></a>p0wn3d - Pwn</h2><p>题目代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">struct __attribute__((__packed__)) data &#123;</span><br><span class="line">  char buf[32];</span><br><span class="line">  int guard;</span><br><span class="line">&#125;;</span><br><span class="line">void ignore(void)</span><br><span class="line">&#123;</span><br><span class="line">  setvbuf(stdout, NULL, _IONBF, 0);</span><br><span class="line">  setvbuf(stdin, NULL, _IONBF, 0);</span><br><span class="line">&#125;</span><br><span class="line">void get_flag(void)</span><br><span class="line">&#123;</span><br><span class="line">  char flag[1024] = &#123; 0 &#125;;</span><br><span class="line">  FILE *fp = fopen(&quot;flag.txt&quot;, &quot;r&quot;);</span><br><span class="line">  fgets(flag, 1023, fp);</span><br><span class="line">  printf(flag);</span><br><span class="line">&#125;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">  struct data first_words;</span><br><span class="line">  ignore(); /* ignore this function */</span><br><span class="line">  printf(&quot;Hello little p0wn3r. Do you have any first words?\n&quot;);</span><br><span class="line">  fgets(first_words.buf, 64, stdin);</span><br><span class="line">  sleep(2);</span><br><span class="line">  puts(&quot;Man that is so cute&quot;);</span><br><span class="line">  sleep(2);</span><br><span class="line">  puts(&quot;I remember last year people were screaming at the little p0wn3rs.. like AAAAAAAAAAAAAAAAAAAAAAAAAAAAA!&quot;);</span><br><span class="line">  sleep(2);</span><br><span class="line">  puts(&quot;Don&#x27;t worry little one. I won&#x27;t let them do that to you. I&#x27;ve set up a guard&quot;);</span><br><span class="line">  if (first_words.guard == 0x42424242) &#123;</span><br><span class="line">    get_flag();</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>代码中，定义了一个结构体，前32位为buf，后面为guard，而在main函数中，由于给buf赋值时限制大小为，所以在给buf赋值32字节的A之后，加上4字节的B，会使多余的数据溢出至guard</p>
<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="Passwords"><a href="#Passwords" class="headerlink" title="Passwords"></a>Passwords</h2><p>下载到.kdbx文件，搜索后为KeePass的数据文件，遂使用<code>keepass2john Database.kdbx &gt;&gt; hash.txt</code> 得到keepass密码的hash <img src="http://img.goubuli.online/blog/20250324173104.png" alt="Pasted image 20250323210647.png"> 再使用hashcat进行爆破（需要将前面的”Database：”删去） <code>hashcat -m 13400 hash.txt -a 0 rockyou.txt</code> 得到密码为： <img src="http://img.goubuli.online/blog/20250324173128.png" alt="Pasted image 20250323211019.png"> 随后拿密码进入keepass中翻找一番即可得到flag</p>
<h2 id="Active-1-Domain-Access"><a href="#Active-1-Domain-Access" class="headerlink" title="Active 1: Domain Access"></a>Active 1: Domain Access</h2><h3 id="第一段"><a href="#第一段" class="headerlink" title="第一段"></a>第一段</h3><p>dan用户的桌面上有木马文件以及一些输出文件，asreproast的输出中有第一段flag，还找到了emily用户密码的hash</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Eval-is-Evil"><a href="#Eval-is-Evil" class="headerlink" title="Eval is Evil"></a>Eval is Evil</h2><p>题目如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import random</span><br><span class="line">def main():</span><br><span class="line">    print(&quot;Let&#x27;s play a game, I am thinking of a number between 0 and&quot;, 2 ** 64, &quot;\n&quot;)</span><br><span class="line">    try:</span><br><span class="line">        guess = eval(input(&quot;What is the number?: &quot;))</span><br><span class="line">    except:</span><br><span class="line">        guess = 0</span><br><span class="line">    correct = random.randint(0, 2**64)</span><br><span class="line">    if (guess == correct):</span><br><span class="line">        print(&quot;\nCorrect! You won the flag!&quot;)</span><br><span class="line">        flag = open(&quot;flag.txt&quot;, &quot;r&quot;).readline()</span><br><span class="line">        print(flag)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;\nYou lost lol&quot;)</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p>发现是没有进行过滤的pyjail，直接<code>__import__(&quot;os&quot;).system(&quot;cat flag.txt&quot;)</code>秒了 <img src="http://img.goubuli.online/blog/20250324173146.png" alt="Pasted image 20250323213334.png"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-01-14T07:06:13.000Z" title="2025/1/14 15:06:13">2025-01-14</time>发表</span><span class="level-item"><time dateTime="2025-05-27T14:53:48.938Z" title="2025/5/27 22:53:48">2025-05-27</time>更新</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/244cb481.html">信息搜集的艺术</a></p><div class="content"><h1 id="资产搜集"><a href="#资产搜集" class="headerlink" title="资产搜集"></a>资产搜集</h1><h2 id="icp备案"><a href="#icp备案" class="headerlink" title="icp备案"></a>icp备案</h2><p>天眼查：<a target="_blank" rel="noopener" href="https://www.tianyancha.com/">https://www.tianyancha.com/</a><br>ICP备案查询网：<a target="_blank" rel="noopener" href="http://www.beianbeian.com/">http://www.beianbeian.com/</a><br>国家企业信用信息公示系统：<a target="_blank" rel="noopener" href="http://www.gsxt.gov.cn/index.html">http://www.gsxt.gov.cn/index.html</a><br>爱站的备案查询：<a target="_blank" rel="noopener" href="https://icp.aizhan.com">https://icp.aizhan.com</a><br>备案历史：<a target="_blank" rel="noopener" href="https://icplishi.com/">https://icplishi.com/</a></p>
<h3 id="icpsearch"><a href="#icpsearch" class="headerlink" title="icpsearch"></a>icpsearch</h3><h4 id="工具地址"><a href="#工具地址" class="headerlink" title="工具地址"></a>工具地址</h4><p><a target="_blank" rel="noopener" href="https://github.com/A10ha/ICPSearch.git">https://github.com/A10ha/ICPSearch.git</a></p>
<h4 id="工具用法"><a href="#工具用法" class="headerlink" title="工具用法"></a>工具用法</h4><p>查询单个域名/公司备案信息</p>
<p><code>ICPSearch.exe -d XXX.com</code></p>
<p><code>ICPSearch.exe -d XXX公司</code></p>
<h2 id="子域名搜集"><a href="#子域名搜集" class="headerlink" title="子域名搜集"></a>子域名搜集</h2><h1 id="人员搜集"><a href="#人员搜集" class="headerlink" title="人员搜集"></a>人员搜集</h1><p>大多数人会习惯在社交网站上使用一个用户名，可利用此习惯对特定用户搜集其他社交平台信息</p>
<p>在国内若掌握其常用手机号码也可通过社交平台可能认识的人搜集</p>
<h2 id="sherlock"><a href="#sherlock" class="headerlink" title="sherlock"></a>sherlock</h2><h3 id="工具地址-1"><a href="#工具地址-1" class="headerlink" title="工具地址"></a>工具地址</h3><p><a target="_blank" rel="noopener" href="https://github.com/sherlock-project/sherlock">https://github.com/sherlock-project/sherlock</a></p>
<h3 id="工具用法-1"><a href="#工具用法-1" class="headerlink" title="工具用法"></a>工具用法</h3><p><code>Sherlock test</code></p>
<p><img src="http://img.goubuli.online/blog/20250114160038.png" alt="image-20250114160031521"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-11-15T16:20:45.000Z" title="2024/11/16 00:20:45">2024-11-16</time>发表</span><span class="level-item"><time dateTime="2025-05-27T14:52:46.089Z" title="2025/5/27 22:52:46">2025-05-27</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Writeup/">Writeup</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/4edcf23d.html">2024-11-ISCTF-Crypto-wp</a></p><div class="content"><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="我和小蓝鲨的秘密"><a href="#我和小蓝鲨的秘密" class="headerlink" title="我和小蓝鲨的秘密"></a>我和小蓝鲨的秘密</h2><p>简单阅读代码后发现是将原图片每个像素点的r,g,b值进行加密，加密过程中n的值较小，直接分解即可，简单的rsa解密过程，之后将原始图片的r,g,b还原即可</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from PIL import Image</span><br><span class="line">import numpy as np</span><br><span class="line">n = <span class="number">29869349657224745144762606999</span></span><br><span class="line">p=<span class="number">160216064374859</span></span><br><span class="line">q=<span class="number">186431677583461</span></span><br><span class="line">e  =<span class="number">65537</span></span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">def decry(c):</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line">data = np.load(r<span class="string">&quot;encrypted_image.npy&quot;</span>,allow_pickle=True)</span><br><span class="line">h = <span class="number">2065</span></span><br><span class="line">w = <span class="number">712</span></span><br><span class="line">image = Image.new(<span class="string">&quot;RGB&quot;</span>, (w,h))</span><br><span class="line"><span class="keyword">for</span> i in range(w):</span><br><span class="line">    <span class="keyword">for</span> j in range(h):</span><br><span class="line">        r = decry(data[i, j, <span class="number">0</span>])</span><br><span class="line">        g = decry(data[i, j, <span class="number">1</span>])</span><br><span class="line">        b = decry(data[i, j, <span class="number">2</span>])</span><br><span class="line">        image.putpixel((i, j), (r, g, b))</span><br><span class="line">image.save(<span class="string">&quot;custom_rgb_image.png&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="ChaCha20-Poly1305"><a href="#ChaCha20-Poly1305" class="headerlink" title="ChaCha20-Poly1305"></a>ChaCha20-Poly1305</h2><p>这道题比较简单，只需要知道crypto库的使用以及能看出key？.txt文件中是base92加密的结果即可</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Cipher import ChaCha20_Poly1305</span><br><span class="line"></span><br><span class="line">key = bytes.fromhex(<span class="string">&quot;173974535637a5ef30a116b03d00bd2fe751951ca3eaa62daec2b8f5ca5b6135&quot;</span>)</span><br><span class="line">Encrypted_Flag = bytes.fromhex(<span class="string">&quot;20408b9fc498063ad53a4abb53633a6a15df0ddaf173012d620fa33001794dbb8c038920273464e13170e26d08923aeb&quot;</span>)</span><br><span class="line">Tag=bytes.fromhex(<span class="string">&quot;70ffcc508bf4519e7616f602123c307b&quot;</span>)</span><br><span class="line">Nonce=bytes.fromhex(<span class="string">&quot;d8ebeedec812a6d71240cc50&quot;</span>)</span><br><span class="line"></span><br><span class="line">cipher = ChaCha20_Poly1305.new(key=key, nonce=Nonce)</span><br><span class="line">flag = cipher.decrypt_and_verify(Encrypted_Flag, Tag)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h2 id="蓝鲨的费马"><a href="#蓝鲨的费马" class="headerlink" title="蓝鲨的费马"></a>蓝鲨的费马</h2><p>参考风二西大佬的视频<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1po4y1E7az/?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV1po4y1E7az/?spm_id_from=333.999.0.0</a></p>
<p>首先进行推导</p>
<script type="math/tex; mode=display">
leak = (d+(pow(p,q,n)+pow(q,p,n)))</script><p>由于p，q均小于n，将</p>
<script type="math/tex; mode=display">
q^p \equiv 1 \mod q \\
p^q \equiv 1 \mod p</script><p>得到</p>
<script type="math/tex; mode=display">
leak = (d + p +q) \mod n</script><p>因为</p>
<script type="math/tex; mode=display">
c^d \equiv m (\mod n)\\
d = leak - (p+q)</script><p>所以推得</p>
<script type="math/tex; mode=display">
c^{l-(p+q)} \equiv m (\mod n)</script><p>由</p>
<script type="math/tex; mode=display">
phi = (p-1)*(q-1)</script><p>推得</p>
<script type="math/tex; mode=display">
phi = n+1-(p+q)</script><p>根据欧拉定理：</p>
<script type="math/tex; mode=display">
a^{\phi(m)} \equiv 1 (\mod)</script><p>所以</p>
<script type="math/tex; mode=display">
c^{phi} \equiv 1(\mod n)\\
c^{n+1-(p+q)} \equiv 1 (\mod n)\\
c^{n+1}*c^{-(p+q)} \equiv 1(\mod n)\\
c^{(n+1)}*c^{-(p+q)}*c^{p+q} \equiv c^{(p+q)}(\mod n)</script><p>所以</p>
<script type="math/tex; mode=display">
c^{n+1} \equiv c^{p+q} \mod n\\
c^{leak}*c^{-(n+1)}\equiv m \mod n\\
c^{leak}*c^{-(p+q)} \equiv m \mod n\\
c^{leak-(p+q)} \equiv m \mod n</script><p>搓脚本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">c= <span class="number">8989289659072309605793417141528767265266446236550650613514493589798432446586991233583435051268377555448062724563967695425657559568596372723980081067589103919296476501677424322525079257328042851349095575718347302884996529329066703597604694781627113384086536158793653551546025090807063130353950841148535682974762381044510423210397947080397718080033363000599995100765708244828566873128882878164321817156170983773105693537799111546309755235573342169431295776881832991533489235535981382958295960435126843833532716436804949502318851112378495533302256759494573250596802016112398817816155228378089079806308296705261876583997</span></span><br><span class="line">n= <span class="number">13424018200035368603483071894166480724482952594135293395398366121467209427078817227870501294732149372214083432516059795712917132804111155585926502759533393295089100965059106772393520277313184519450478832376508528256865861027444446718552169503579478134286009893965458507369983396982525906466073384013443851551139147777507283791250268462136554061959016630318688169168797939873600493494258467352326974238472394214986505312411729432927489878418792288365594455065912126527908319239444514857325441614280498882524432151918146061570116187524918358453036228204087993064505391742062288050068745930452767100091519798860487150247</span></span><br><span class="line">leak= <span class="number">9192002086528025412361053058922669469031188193149143635074798633855112230489479254740324032262690315813650428270911079121913869290893574897752990491429582640499542165616254566396564016734157323265631446079744216458719690853526969359930225042993006404843355356540487296896949431969541367144841985153231095140361069256753593550199420993461786814074270171257117410848796614931926182811404655619662690700351986753661502438299236428991412206196135090756862851230228396476709412020941670878645924203989895008014836619321109848938770269989596541278600166088022166386213646074764712810133558692545401032391239330088256431881</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">m = <span class="title function_ invoke__">pow</span>(c,leak-n-<span class="number">1</span>,n)</span><br><span class="line"><span class="keyword">print</span>(<span class="title function_ invoke__">long_to_bytes</span>(m))</span><br></pre></td></tr></table></figure>
<h2 id="小蓝鲨的数学题"><a href="#小蓝鲨的数学题" class="headerlink" title="小蓝鲨的数学题"></a>小蓝鲨的数学题</h2><p>参考 <font style="color:rgb(34, 34, 38);">2020网鼎杯 you raise me up</font></p>
<font style="color:rgb(34, 34, 38);">根据题目条件和提示，我们已知</font>

<script type="math/tex; mode=display">
c = pow(m,flag,p)</script><p>利用sagemath解题</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">m = <span class="number">5321153468370294351697008906248782883193902636120413346203705810525086437271585682015110123362488732193020749380395419994982400888011862076022065339666193</span></span><br><span class="line">c = <span class="number">7383779796712259466884236308066760158536557371789388054326630574611014773044467468610300619865230550443643660647968413988480055366698747395046400909922513</span></span><br><span class="line">p = <span class="number">2</span>**<span class="number">512</span></span><br><span class="line">d=<span class="title function_ invoke__">discrete_log</span>(c,<span class="title function_ invoke__">mod</span>(m,p))</span><br><span class="line">import libnum</span><br><span class="line"><span class="keyword">print</span>(libnum.<span class="title function_ invoke__">n2s</span>(<span class="keyword">int</span>(d)))</span><br></pre></td></tr></table></figure>
<h2 id="小蓝鲨的密码"><a href="#小蓝鲨的密码" class="headerlink" title="小蓝鲨的密码"></a>小蓝鲨的密码</h2><p>下载附件后发现一个压缩包与类似rabbit/AES密文和图片，经过尝试压缩包密码为图片的名字，打开压缩包后是密码本，观察其中的密码后，根据往年经验，密码应该为blueshark或者isctf2024，前者上一步已经用过，所以尝试密码为isctf2024，发现AES成功解密。</p>
<h2 id="小蓝鲨的方程"><a href="#小蓝鲨的方程" class="headerlink" title="小蓝鲨的方程"></a>小蓝鲨的方程</h2><p>题目中生成的p1为</p>
<script type="math/tex; mode=display">
p_1 = p^4 +a</script><p>a只有777为，对其开4次方后只有5，位数较小，所以可以在对p1开4次方之后递减得到p，之后根据欧拉函数得到phi，算出s的值，之后通过二项式定理以及数论推导，搓脚本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">c1= <span class="number">671390498592586008552998377599101093977542184109077889081448730480869018650843045119891777468161631085086340705902115332025675787789530562679603254577287153918966364523848382506106179394235772395029788721306186952016420794804145631124905952103136061076643266886961178241381892015555099638200222249447194504082451341122502519637821695210573997670753981061458264118355417889153180841281073262935937836447460470926729282834006229571453935760593644658459098721652426154970766417292435960463905367868753821950303919781798234432998272038029063155193184039985018137026245365188171178677898869374676546799536208952198558258306460302868688355653022725288744014143221560882404431652751343944983442109327</span></span><br><span class="line">c = <span class="number">8641190030376811670503537177719719233418166235794962118828671236836174132083208517733734760455990850156371205118391537919769888760384574011411232571257192285256730733174399297826587479261381970232162702657952399683882650083181048279650913795429823628186888540572704055008102853692060360140858142686334722286525699998854566609078547487420929457446776757558492454916447188774943818970599916514467335772992690805247630814156710861067503956707301402347944233660194395192354000788262111000900574820275786269075882923600474781645848712157460135387134196156906258218217831988828360827613420801773911833194097791649069743116686685667300622630909231822986237104627385544169938138006242341269672868611269202418482629393372933567053272565557137741441902377611003983050084491513897727856173625922194300103448148829004025229567101761111396110940066254801762424343522707712480796358754008120503317686600144600226149617189681233392693738216138797012278242152852923361635415564580582002132107424154426980566696622448291815571736676562214017436</span></span><br><span class="line">n = <span class="number">1076246859437269645898003764327104347852443049519429833372038915264009774423737482018987571807662568251485615769880354898666799006772572239466617428164721157850526408878346223839884319846641438292436373441749602341461361190584638190903978829024853974880636148520803145113551453821058269641304504880310836801494499720662704717315748614372503735165114899680682056477494953525794354656896362929510309669119173103242509398650608116835276076364248473952717811633756784397347121601006659623317417388283638159905288128181587304367489096254611610975352096229116491567502061775862811850081040850421151385474249060884479729988512713640536139010928836126719149031115182144744359297169350288886555784650111</span></span><br><span class="line">p1 = <span class="number">145356063641618996012874664536921616978986640263438210169671010403677822239343590475177543891188656103067696467174379510912427160232486984044862545338401652910975162942038201716552753723984593267892098222213049269335313670049037479410635628460505327693176152061750827570561482918795206276991967169087371403553</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number import *</span><br><span class="line"><span class="keyword">from</span> gmpy2 import *</span><br><span class="line">p_ = <span class="title function_ invoke__">iroot</span>(p1,<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    q_ = n <span class="comment">// p_</span></span><br><span class="line">    <span class="keyword">if</span> p_ * q_ == n:</span><br><span class="line">        p = <span class="keyword">int</span>(p_)</span><br><span class="line">        q = <span class="keyword">int</span>((<span class="title function_ invoke__">iroot</span>(q_,<span class="number">4</span>))[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    p_ -= <span class="number">1</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q**<span class="number">4</span>-q**<span class="number">3</span>)</span><br><span class="line">d = <span class="title function_ invoke__">inverse</span>(e,phi)</span><br><span class="line">s = <span class="title function_ invoke__">pow</span>(c1,d,n)</span><br><span class="line"><span class="keyword">print</span>(s)</span><br><span class="line">m1 = (c-<span class="number">1</span>)<span class="comment">//(s**3)</span></span><br><span class="line"><span class="keyword">print</span>(<span class="title function_ invoke__">long_to_bytes</span>(m1))</span><br></pre></td></tr></table></figure>
<h2 id="蓝鲨的RSA"><a href="#蓝鲨的RSA" class="headerlink" title="蓝鲨的RSA"></a>蓝鲨的RSA</h2><p>查看hint后发现，是维纳定理</p>
<p>根据连分数定理</p>
<script type="math/tex; mode=display">
\left| a- \frac{c}{d} \right|< \frac{1}{2*d^2}</script><p>可得c/d是a的一个连分数近似</p>
<p>推导：</p>
<script type="math/tex; mode=display">
leak=\frac{8*H*P-1}{16*P*P}=\frac{8*H*P}{16*P*P}- \frac{1}{16*P*P}=\frac{H}{2*P}-\frac{1}{16*P*P}</script><p>给leak*2得到</p>
<script type="math/tex; mode=display">
leak*2 = \frac{H}{P}-\frac{1}{8*P*P}\\
\left|leak*2-\frac{H}{P} \right|= \frac{1}{8*P*P}<\frac{1}{2*P*P}</script><p>计算leak*2的连分数即可得到h，p</p>
<p>下一步是基本的格密码</p>
<p>已知</p>
<script type="math/tex; mode=display">
h = f^{-1}*g (\mod p)\\
h*f \equiv g (\mod p)\\
g = hf-kp</script><p>于是构造格</p>
<script type="math/tex; mode=display">
\begin{pmatrix}
f&-k
\end{pmatrix}*
\begin{pmatrix}
1&h\\
0&p
\end{pmatrix}
=
\begin{pmatrix}
f&g
\end{pmatrix}</script><p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">587245179027322480379581200283415189810421958968516831191660631552695197401940961725169763339428980298128692606951200581483431566182271569207988054537414289564013883171160614196522169980339024564884190765084419167938640701193928669</span></span><br><span class="line">hint = <span class="number">0.2427542737153618793334900104191212626446625872340179613972610728976081994921862517310186626304527115125924716035632505287111236596234811779375148657365336957626454491865164520834975233144235103885081268955448330597818844340656652982593545877449810282619387305007246499089258519062093814083383071737897364213169497762760797899310673216754376885295598952272100016962368762532805864796748393317534908268379601445004775495237901072144236328105526403608646831124542336002540011176406194984370372589752234640498423911217119220030242197564695880261480071310815379681250975672935544404797155655708441222387631967447088319826137200280810029390387418159394276760100487636516708987579464183208860911063948902432948269805493252899815187044807603000344378890835564906163242023600624338694473573763088471321731611077227112205396909637906507673367598721218000123789690455125909411309668615810240938664264212370815385282488986625554704015828254539339719586211726300858711328516487805251366293457402531199532556110786048074755505680210260049</span></span><br><span class="line">n = <span class="number">839799159583571337450826982895478997157381520448790705455708438948150905361244823725400304016136863419723271227616684280477524669207590477657886623628732394537008838314015048569652202355464477680540884654473950183135276735347866051</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">hint = hint *<span class="number">2</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number import *</span><br><span class="line">cf = <span class="title function_ invoke__">continued_fraction</span>(hint)</span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="number">1000</span>):</span><br><span class="line">    k = cf.<span class="title function_ invoke__">numerator</span>(i)</span><br><span class="line">    x = cf.<span class="title function_ invoke__">denominator</span>(i)</span><br><span class="line">    <span class="keyword">if</span> <span class="title function_ invoke__">isPrime</span>(x) <span class="keyword">and</span> x.<span class="title function_ invoke__">bit_length</span>()==<span class="number">512</span>:</span><br><span class="line">        <span class="keyword">print</span>(k,x)</span><br><span class="line">        h,p = k,x</span><br><span class="line">Ge = <span class="title function_ invoke__">Matrix</span>(ZZ,[[<span class="number">1</span>,h],[<span class="number">0</span>,p]])</span><br><span class="line"><span class="keyword">print</span>(Ge.<span class="title function_ invoke__">LLL</span>())</span><br><span class="line">f,g = Ge.<span class="title function_ invoke__">LLL</span>()[<span class="number">0</span>]</span><br><span class="line">f,g = <span class="title function_ invoke__">abs</span>(f),<span class="title function_ invoke__">abs</span>(g)</span><br><span class="line"><span class="keyword">print</span>(f,g)</span><br><span class="line">q = n <span class="comment">//f</span></span><br><span class="line">phi = (f-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="title function_ invoke__">inverse</span>(e,phi)</span><br><span class="line"><span class="keyword">print</span>(<span class="title function_ invoke__">long_to_bytes</span>(<span class="title function_ invoke__">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>
<h2 id="ezmath"><a href="#ezmath" class="headerlink" title="ezmath"></a>ezmath</h2><p>根据题目给出的代码，是需要计算gamma函数当x取值为5/2时，使用在线计算器计算出的结果不是需要的key，但是应该差别不大，所以我们进行一个爆破</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="number">3293403881791372</span></span><br><span class="line">ke1 = <span class="number">3293403881738537</span></span><br><span class="line">ke2 = <span class="number">3293403881791370</span></span><br><span class="line">s = b<span class="string">&quot;n2SQK64JMsXstCtZurBiz81pMr3ZmgMjhuyL67hssm3shqJGYGfS/mWubINeE5HZ&quot;</span></span><br><span class="line">import random</span><br><span class="line"><span class="keyword">from</span> hashlib import md5</span><br><span class="line">import base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher import AES</span><br><span class="line">import tqdm</span><br><span class="line"></span><br><span class="line">def <span class="title function_ invoke__">pad</span>(data):</span><br><span class="line">    data = data.<span class="title function_ invoke__">encode</span>(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="title function_ invoke__">len</span>(data) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        data += b<span class="string">&#x27;\x00&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">def <span class="title function_ invoke__">decode</span>(key, enc_data):</span><br><span class="line">    mode = AES.MODE_ECB</span><br><span class="line">    aes = AES.<span class="keyword">new</span>(<span class="title function_ invoke__">pad</span>(key), mode)</span><br><span class="line">    enc_data = base64.<span class="title function_ invoke__">decodebytes</span>(enc_data)</span><br><span class="line">    decrypted_data = aes.<span class="title function_ invoke__">decrypt</span>(enc_data)</span><br><span class="line">    <span class="keyword">return</span> decrypted_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key in tqdm.<span class="title function_ invoke__">trange</span>(<span class="number">329340360000000</span>,<span class="number">329340399999999</span>):</span><br><span class="line">    key1 = key</span><br><span class="line">    random.<span class="title function_ invoke__">seed</span>(key1)</span><br><span class="line">    new_key = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">str</span>(random.<span class="title function_ invoke__">getrandbits</span>(<span class="number">256</span>)).<span class="title function_ invoke__">encode</span>(<span class="string">&#x27;utf-8&#x27;</span>)).<span class="title function_ invoke__">hexdigest</span>()</span><br><span class="line">    en_m = <span class="title function_ invoke__">decode</span>(new_key, s)</span><br><span class="line">    <span class="keyword">if</span> b<span class="string">&#x27;ISCTF&#x27;</span> in en_m:</span><br><span class="line">        <span class="keyword">print</span>(en_m)</span><br><span class="line">        <span class="keyword">print</span>(new_key)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>最后根据提示发现应该是修改好代码后计算出来的key取前15位</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-11-06T13:14:36.000Z" title="2024/11/6 21:14:36">2024-11-06</time>发表</span><span class="level-item"><time dateTime="2025-05-27T14:53:38.160Z" title="2025/5/27 22:53:38">2025-05-27</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E8%AE%BA/">数论</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/a9fc6368.html">数论-快速幂运算</a></p><div class="content"><h1 id="快速幂运算"><a href="#快速幂运算" class="headerlink" title="快速幂运算"></a>快速幂运算</h1><p>幂运算<script type="math/tex">a^m</script>是指m个n相乘，当a，m太大时，计算时间太长，使用快速幂算法可以降低时间复杂度。常见的算法有二进制与指数折半两种，时间复杂度相同</p>
<p>首先我们知道</p>
<p>$ a^{m+n} = a^m *a^n $</p>
<p>二进制的方法就是通过指数的二进制表示将幂运算拆解为一个个很小的任务</p>
<p>指数折半就是将指数分解为2的m次方形式，例如</p>
<p>$ 3^{12} = (3^2)^3 = 9^3 $</p>
<p>通过缩小指数的大小，减少循环的次数，以此来达到幂运算的结果不变但是加快幂运算速度的效果。</p>
<h2 id="二进制取幂"><a href="#二进制取幂" class="headerlink" title="二进制取幂"></a>二进制取幂</h2><p>当n的m次方中，m取9时，9的二进制为1001，转化关系如下：</p>
<script type="math/tex; mode=display">
9 = 1*2^3+0*2^2+0*2^1+1*2^0</script><p>于是，通过幂运算的性质，原本的复杂的幂运算可以拆分为</p>
<script type="math/tex; mode=display">
n^{9_{(10)}} = n^{1001_{(2)}} = n^{1*2^3+0*2^2+0*2^1+1*2^0}=n^{1*2^3}*n^{0*2^2}*n^{0*2^1}*n^{1*2^0}</script><p>由于我们知道任何数乘0都为0，任何数的0次方都为1，所以，实际上拆分的幂运算为</p>
<script type="math/tex; mode=display">
n^9 = n^{1*2^3}*n^{1*2^0}</script><p>由此发现，实际上只需要计算众多小任务中二进制位等于1部分的累乘即可</p>
<p>实现代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def binpow(a, b):</span><br><span class="line">    res = 1</span><br><span class="line">    <span class="keyword">while</span> b &gt; 0:</span><br><span class="line">        <span class="keyword">if</span> b &amp; 1:</span><br><span class="line">            res = res * a</span><br><span class="line">        a = a * a</span><br><span class="line">        b &gt;&gt;= 1</span><br><span class="line">    <span class="built_in">return</span> res</span><br></pre></td></tr></table></figure>
<h1 id="矩阵快速幂运算"><a href="#矩阵快速幂运算" class="headerlink" title="矩阵快速幂运算"></a>矩阵快速幂运算</h1><p>根据线性代数中我们学到的知识，矩阵乘法的原理就是左行乘右列，这里不多描述，代码实现如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(i=1;i&lt;=n;i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(j=1;j&lt;=n;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(k=1;k&lt;=n;k++)</span><br><span class="line">        &#123;</span><br><span class="line">            c[i][j] = c[i][j] + a[i][k] * b[k][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将矩阵乘法套在快速幂运算中，也就构成了矩阵快速幂运算</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def multiply_matrices(a, b):</span><br><span class="line">    res = [[0, 0], [0, 0]]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(0, 2):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(0, 2):</span><br><span class="line">            <span class="keyword">for</span> p <span class="keyword">in</span> range(0, 2):</span><br><span class="line">                res[i][j] = (res[i][j] + a[i][p] * b[p][j]) % M</span><br><span class="line">    <span class="built_in">return</span> res</span><br><span class="line">b = 次方数</span><br><span class="line"><span class="keyword">while</span> b &gt; 0:</span><br><span class="line">    <span class="keyword">if</span> b &amp; 1:</span><br><span class="line">        ans = multiply_matrices(ans, base)</span><br><span class="line">    base = multiply_matrices(base, base)</span><br><span class="line">    b &gt;&gt;= 1</span><br></pre></td></tr></table></figure>
<h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="2024-11-SICTF-Round4-Math-Cocktail"><a href="#2024-11-SICTF-Round4-Math-Cocktail" class="headerlink" title="2024.11.SICTF#Round4.Math Cocktail"></a>2024.11.SICTF#Round4.Math Cocktail</h2><p>题目</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from secret import key</span><br><span class="line">x = key</span><br><span class="line">M = 94665789456132156456789461321289656332321</span><br><span class="line">n = 123456789123456789</span><br><span class="line">k = x + pow(x,-1,M)</span><br><span class="line">result = pow(x,n,M) + pow(x,-n,M)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;k = &quot;</span> + str(k))</span><br><span class="line">flag = <span class="string">&quot;SICTF&#123;&quot;</span>+str(result)+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="comment">#k = 15396893775857205606087136852231851457937</span></span><br></pre></td></tr></table></figure>
<p>根据题意，我们需要求</p>
<script type="math/tex; mode=display">
result = x^n + x^{n-1}</script><p>我们已知</p>
<script type="math/tex; mode=display">
k = x + x^{-1}</script><p>于是，设</p>
<script type="math/tex; mode=display">
a_n = x^n +x^{n-1}</script><p>我们有</p>
<script type="math/tex; mode=display">
a_0 = 2\\
a_1 = k</script><p>我们又知道</p>
<script type="math/tex; mode=display">
a_n*a_1 = (x^n+x^{n-1})*(x+x^{-1})= x^{n+1}+x^{-(n+1)}+x^{n-1}+x^{-(n-1)}=a_{n+1}+a_{n-1}\\
a_{n+1} = k*a_n - a_{n-1}\\
a_{n} = k*a_{n-1} - a_{n-2}</script><p>之后将递推关系转化为矩阵乘法</p>
<script type="math/tex; mode=display">
\begin{pmatrix}
a_n \\
a_{n-1}
\end{pmatrix}
=
\begin{pmatrix}
k & -1 \\
1 & 0
\end{pmatrix}
\begin{pmatrix}
a_{n-1} \\
a_{n-2}
\end{pmatrix}</script><p>exp</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">def multiply_matrices(a, b):</span><br><span class="line">    res = [[0, 0], [0, 0]]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(0, 2):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(0, 2):</span><br><span class="line">            <span class="keyword">for</span> p <span class="keyword">in</span> range(0, 2):</span><br><span class="line">                res[i][j] = (res[i][j] + a[i][p] * b[p][j]) % M</span><br><span class="line">    <span class="built_in">return</span> res</span><br><span class="line">M = 94665789456132156456789461321289656332321</span><br><span class="line">n = 123456789123456789</span><br><span class="line">k = 15396893775857205606087136852231851457937</span><br><span class="line">base = [[k, 1], [-1, 0]]</span><br><span class="line">ans = [[(k*k-2) % M, k % M], [0, 0]]</span><br><span class="line">b = n - 2</span><br><span class="line"><span class="keyword">while</span> b &gt; 0:</span><br><span class="line">    <span class="keyword">if</span> b &amp; 1:</span><br><span class="line">        ans = multiply_matrices(ans, base)</span><br><span class="line">    base = multiply_matrices(base, base)</span><br><span class="line">    b &gt;&gt;= 1</span><br><span class="line"><span class="built_in">print</span>((ans[<span class="number">0</span>][<span class="number">0</span>] + M) % M)</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-11-04T13:14:49.000Z" title="2024/11/4 21:14:49">2024-11-04</time>发表</span><span class="level-item"><time dateTime="2025-05-26T09:55:43.627Z" title="2025/5/26 17:55:43">2025-05-26</time>更新</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/148dea62.html">rsa-smooth攻击</a></p><div class="content"><h1 id="涉及知识点"><a href="#涉及知识点" class="headerlink" title="涉及知识点"></a>涉及知识点</h1><p>光滑数：指能分解成小素数乘积的正整数</p>
<p>B-光滑数：若一个光滑数的最大小质数因子&lt;=B,则称该光滑数为B-光滑数</p>
<p>费马小定理:</p>
<p><img src="http://img.goubuli.online/blog/20241104211624.svg+xml" alt="image"></p>
<h1 id="p-1光滑"><a href="#p-1光滑" class="headerlink" title="p-1光滑"></a>p-1光滑</h1><p><img src="http://img.goubuli.online/blog/20241104211700.svg+xml" alt="image"></p>
<p>由于p为质数，设a为整数且与p互质，则有</p>
<p><img src="http://img.goubuli.online/blog/20241104211731.svg+xml" alt="image"></p>
<p>又因为p-1为因子互不相同的B-光滑数，所以</p>
<p><img src="http://img.goubuli.online/blog/20241104211838.svg+xml" alt="image"></p>
<p>故p的倍数可以求出来，且我们有n=p*q。所以</p>
<p><img src="http://img.goubuli.online/blog/20241104211910.svg+xml" alt="image"></p>
<h3 id="Pollard’s-p-1"><a href="#Pollard’s-p-1" class="headerlink" title="Pollard’s p-1"></a>Pollard’s p-1</h3><p>由于我们只关注gcd的结果，不需要计算B！的值，我们只需要令B=1，2，3，…..,计算出gcd结果即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">n = <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    a = powmod(a, n, N)</span><br><span class="line">    res = gcd(a-<span class="number">1</span>, N)</span><br><span class="line">    <span class="keyword">if</span> res != <span class="number">1</span> <span class="keyword">and</span> res != N:</span><br><span class="line">        q = N // res</span><br><span class="line">        d = invert(e, (res-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = powmod(c, d, N)</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    n += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h1 id="p-1光滑-1"><a href="#p-1光滑-1" class="headerlink" title="p+1光滑"></a>p+1光滑</h1><font style="color:rgb(77, 77, 77);">Williams’s p + 1</font>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">mlucas</span>(<span class="params">v, a, n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Helper function for williams_pp1().  Multiplies along a Lucas sequence modulo n. &quot;&quot;&quot;</span></span><br><span class="line">    v1, v2 = v, (v**<span class="number">2</span> - <span class="number">2</span>) % n</span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">bin</span>(a)[<span class="number">3</span>:]: </span><br><span class="line">        v1, v2 = ((v1**<span class="number">2</span> - <span class="number">2</span>) % n, (v1*v2 - v) % n) <span class="keyword">if</span> bit == <span class="string">&quot;0&quot;</span> <span class="keyword">else</span> ((v1*v2 - v) % n, (v2**<span class="number">2</span> - <span class="number">2</span>) % n)</span><br><span class="line">    <span class="keyword">return</span> v1</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> count(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> primegen():</span><br><span class="line">        e = ilog(isqrt(n), p)</span><br><span class="line">        <span class="keyword">if</span> e == <span class="number">0</span>: </span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(e): </span><br><span class="line">            v = mlucas(v, p, n)</span><br><span class="line">        g = gcd(v-<span class="number">2</span>, n)</span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> &lt; g &lt; n: </span><br><span class="line">            <span class="keyword">return</span> g <span class="comment"># g|n</span></span><br><span class="line">        <span class="keyword">if</span> g == n: </span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-11-04T05:43:56.000Z" title="2024/11/4 13:43:56">2024-11-04</time>发表</span><span class="level-item"><time dateTime="2025-05-27T14:52:53.639Z" title="2025/5/27 22:52:53">2025-05-27</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Writeup/">Writeup</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/e8559c8.html">2024.10.SICTF#Round4-wp</a></p><div class="content"><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="模型的秘密"><a href="#模型的秘密" class="headerlink" title="模型的秘密"></a>模型的秘密</h2><p>使用字典爆破压缩包密码</p>
<p>搜索blend找到与3D文件格式有关的blender</p>
<p>发现题目附件中文件头被更改，修改之后使用blender打开查看flag</p>
<p><img src="http://img.goubuli.online/blog/20241104134638.png" alt="image.png"></p>
<p><img src="http://img.goubuli.online/blog/20241104134540.png" alt></p>
<h2 id="派森"><a href="#派森" class="headerlink" title="派森"></a>派森</h2><p>根据音译，文件为py文件，修改后缀后发现代码也被音译，还原大致代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from  import xor</span><br><span class="line">from   import *</span><br><span class="line">flag = <span class="string">&quot;************&quot;</span></span><br><span class="line">int = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(0,len(),4):</span><br><span class="line">    int.append(xor(ord(flag[i]),ord(flag[i+2])))</span><br></pre></td></tr></table></figure>
<p>差不多就是将flag每四个分为一组，第一位与第三位进行异或，第二位和第四位异或，密文中含有第三位和第四位。异或即可得到flag的原文。</p>
<h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p>关注公众号即可</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="SignBase"><a href="#SignBase" class="headerlink" title="SignBase"></a>SignBase</h2><p>base64即可</p>
<h2 id="Smooth"><a href="#Smooth" class="headerlink" title="Smooth"></a>Smooth</h2><p>根据代码，n首先是小素数的乘积，之后＋1，所以p-1是光滑的，使用smooth攻击</p>
<p>exp：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from  Crypto.Util.number import *</span><br><span class="line">N = 11353462911659482113796537452147300926058319193410149519981293344545095869273822230953023429933867057788424748612924709948861133348747189832397098293375764081790597820832766019459982124608221261607650511397189714784056313299551817534654742174637343804047231232241364089289257964139944018168155573510980260130960125621306919129390727418251555408239157881843225479158237727969284756513805560836003067115936987292751142016846824024901372913577548599978847860303760659677939193351221798796221804998385095596961591093782162020167439948314063423204757741472210008357888290333170757522814768955797167174930629344666183821709125207308525214263797625499327774875517941662523738827284067304929843343871569023248931759251331056863803201916908875256305736551124386988450879913404808869417817363510363373493093139804372817316366990863872781848240937733101758906281563575413208242901819275013539759479445299894840593737457394207415306989963459347994339058584475533786264375696277942369426844216474662828121334192775480587740071776080691560820922589751966526187341539255661442517814436944781114380877453502120302247547983180059537220197840688418898830571100216529994749464486853212098379822895838120836692532849021875818941979891105837972315129986493</span><br><span class="line">c = 4598142980961588614870523368474306387497434303187254927457676265871592231881441246092917258758503624096206624791819316260705668875764048374035213672138915662719877795747211803584360349151646264274341548770123417923229997374982757324397146348908248704115062655445309042278469908831635522908894918382861563762003781223067210316435231509359575745828484177064520417698784251000631935361105284031848497200100561554984257265297077176545082009710252149167922123535451717313588884862304552508619154651546264753192894485610685402565486840707709012364088270364787452130288293053818329408433642977483320525542674345001200312959241276966417288770125166249156122793451000156544563900072606708005901579238109781720805374132101363788622676000360345128868422751829657184702090198806325558601552728909032627597688702884484377994243047876011323705947461799669488497113582621976154428096812072612119422667669321557427061098391558516935530727451865151957035156100271891977310043273298085691419672779758845492888551759393825925266903887942750052210444677062600227218953570162640164207895883301679126000642791876167281967081725589618329012476305157314322062703122134504285038691938912783524944917966615556902938825590064899700174139252191278691620663355243</span><br><span class="line">e = 65537</span><br><span class="line">import gmpy2</span><br><span class="line">a = 2</span><br><span class="line">n = 2</span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    a = pow(a, n, N)</span><br><span class="line">    res = gmpy2.gcd(a-1, N)</span><br><span class="line">    <span class="keyword">if</span> res != 1 and res != N:</span><br><span class="line">        q = N // res</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,res)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">    n += 1</span><br><span class="line"></span><br><span class="line">d=gmpy2.invert(e,(res-1)*(q-1))</span><br><span class="line">m=pow(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="next-prime"><a href="#next-prime" class="headerlink" title="next_prime"></a>next_prime</h2><p>给了next_prime，直接使用费马分解拿到p，q</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">import math</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">from Cryptodome.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line">n = 11958388191411693159737723233868177200642855312771636589272066925180521736238782088222469544720240237292008558651656242716943228927612911153093905350043065811853776453271082678856297734699816670221066298151571078839575715976634390967727901295936522621706645886864683564184184197808626753747618171580292981571324190267014128877345111473870762554461674841623076501341477084318792110624423283610948627697772395662746329206056210266975821093875870239401934123066690637191790327090291595067248967533200784706397544202070440488806825607916659163953805033205530899551496221506129549542556866837853127119809134360611350153589</span><br><span class="line">c = 10602368727908312334676265892975307612231309319511015017178654564186172749979627738052483995870388025140270600159107954524376993980949045647370337520644299969292550299798129717198074042121264370311983929042594290226321121639097714569204574387632530578153623781118813035223106106430716561113649761388347227207862016222328885951443891878767280730866193302995220736592745950808566359750940949520997722511969961743175777398751576595421456387998438214806188903746057855596476380404784738717555105866919649086601807350830108805521710188675565963765427930594177874353694184805979235854934856122125278853834603734029710968348</span><br><span class="line">gift = 143003048136494625720615623612005913472507924053937690079082986485649969355472743235179770036996193641198750946508667945561623931811236977039763581123681134310890547763107653222776992418543178066390387385209825190685606728024120446212807710589806258669458993047631033905702244902809204039169931629358263456702579067559691338668237882496453568585374905432631312417129535623987837367199215661733043851565981435234933986864857569158677737153423060041120732727135186371678287680926662892691327401787213342106281956461499522723795617869239148528294553548775690229067500104867437905746412645684721821428282431567702986879179533855920546700706123995719114359958306882907020982377260255340490340263938995699635287224549324332962230238510191824829224191551900441011605052418697617085549543103391184965537110312684637038510114533398510307173011690076219892318860903556489256383303693074652155424333388152193775840529985682153395008472897617946636734810609200156268438329402662168752285341847607694230848883249991722691539384542468611397615969487669898094687344847452861774236267516878551680397732564006255256825307533960791695267034807439791627895625581061889926276814228469856614838307012696777026973517086921078389474757196549594972814371353</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">def fermat_factorization(n):</span><br><span class="line">	factor_list = []</span><br><span class="line">	get_context().precision = 2048</span><br><span class="line">	x = int(math.isqrt(n))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> True:</span><br><span class="line">		x += 1</span><br><span class="line">		y2 = x ** 2 - n</span><br><span class="line">		<span class="keyword">if</span> is_square(y2):</span><br><span class="line">			y2 = mpz(y2)</span><br><span class="line">			get_context().precision = 2048</span><br><span class="line">			y = int(sqrt(y2))</span><br><span class="line">			factor_list.append([x+y, x-y])</span><br><span class="line">		<span class="keyword">if</span> len(factor_list) == 2:</span><br><span class="line">			<span class="built_in">break</span></span><br><span class="line">	<span class="built_in">return</span> factor_list</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">	factor_list = fermat_factorization(gift)</span><br><span class="line">	<span class="comment">#print(factor_list)</span></span><br><span class="line">	[X1, Y1] = factor_list[0]</span><br><span class="line">	[X2, Y2] = factor_list[1]</span><br><span class="line">	p1 = gcd(X1, X2)</span><br><span class="line">	q1 = X1 // p1</span><br><span class="line">	p2 = gcd(Y1, Y2)</span><br><span class="line">	q2 = Y1 // p2</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;p1 =&#x27;</span>,p1)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;p2 =&#x27;</span>,p2)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;q1 =&#x27;</span>,q1)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;q2 =&#x27;</span>,q2)</span><br><span class="line"></span><br><span class="line">	phi = (p1 - 1) * (q1 - 1) * (p2 - 1) * (q2 - 1)</span><br><span class="line">	d = inverse(e, phi)</span><br><span class="line">	flag = long_to_bytes(pow(c, d, n))</span><br><span class="line">	<span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Sighin"><a href="#Sighin" class="headerlink" title="Sighin"></a>Sighin</h2><p>进入靶机后查看robots.txt文件，提示访问<code>/wh3re_1s_thi5_fl4g.php</code>，访问后发现对php代码进行了混淆，</p>
<p>恢复原始代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;wKq=1MDcLg6yYsrnRYivbO7JoWQ9rBhCZuo4DlZOS7_I5+t=UKzp0hdV1FNL2EFd/nxam3cTbPARsw+8Eky5XUpfH0MeTQ3JXtkGf9qj_4NmlHi/SeIVaCAgxGj26vW8PBzu&quot;</span></span><br><span class="line"></span><br><span class="line">a = s[72]+s[116]+s[76]+s[113]+s[124]+s[35]+s[104]+s[63]+s[91]+s[70]+s[24]+s[63]+s[113]</span><br><span class="line">b = s[38]+s[123]+s[115]+s[89]+s[96]+s[60]+s[75]+s[108]+s[32]+s[107]+s[37]+s[131]+s[38]+s[25]+s[75]+s[100]+s[63]+s[68]+s[57]+s[11]+s[70]+s[77]+s[3]+s[3]</span><br><span class="line">c = s[96]+s[89]+s[63]+s[62]+s[115]+s[74]+s[47]+s[47]</span><br><span class="line">e = payload = s[115]+s[65]+s[86]+s[39]+s[70]+s[4]+s[108]+s[124]+s[26]+s[65]+s[16]+s[116]+s[115]+s[103]+s[98]+s[77]+s[92]+s[48]+s[12]+s[44]+s[115]+s[62]+s[58]+s[55]+s[92]+s[37]+s[55]+s[40]+s[116]+s[71]+s[16]+s[83]+s[92]+s[48]+s[75]+s[23]+s[5]+s[74]+s[47]+s[47]</span><br><span class="line">h = s[17]+s[130]+s[106]+s[76]+s[113]+s[68]+s[75]+s[109]+s[55]+s[65]+s[26]+s[47]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a,b,c,e,h)</span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"><span class="variable">$f</span> =  base64_decode(&quot;</span>Z2V0X2RlZmluZWRfdmFycw==<span class="string">&quot;) = get_defined_vars();</span></span><br><span class="line"><span class="string"><span class="variable">$g</span> = W3lc0me_t0_SICTF.2024</span></span><br><span class="line"><span class="string"><span class="variable">$i</span> = system</span></span><br><span class="line"><span class="string">system( get_defined_vars()[_GET][W3lc0me_t0_SICTF.2024])</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>可见关键代码为<code>system( get_defined_vars()[_GET][W3lc0me_t0_SICTF.2024])</code>也就是get传参执行命令</p>
<p>但是get传进去的变量名中包含非法字符，根据搜索，可以通过转化错误，当参数中有中括号时，<code>[</code>被转化成<code>_</code>,且之后的非法字符不会被不会被转化为下划线，所以构建payload：<code>[http://27.25.151.29:34141//wh3re_1s_thi5_fl4g.php?W3lc0me[t0_SICTF.2024=cat%20/flag]</code></p>
<p><img src="http://img.goubuli.online/blog/20241104134710.png" alt="image.png"></p>
<h2 id="Upl0ad"><a href="#Upl0ad" class="headerlink" title="Upl0ad"></a>Upl0ad</h2><p>文件上传题目，ctrl u 查看源代码后发现对于文件类型的转换在前端，只有要禁用js后即可上传木马文件</p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Exc"><a href="#Exc" class="headerlink" title="Exc??"></a>Exc??</h2><p>查看表格后发现需要将flag的ascii码套入公式后等于所给的值，直接爆破即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = [3976,5728,5640,4232,5272,3776,6464	,6136,5408]</span><br><span class="line">b = [876,1147,1182,824,1082,866,1361,1278,1087]</span><br><span class="line">c = [16511,24822,26991,11999,21215,16374,37800,32739,21505]</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> range(9):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(32,127):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(32,127):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(32,127):</span><br><span class="line">                <span class="keyword">if</span> (i &lt;&lt; <span class="string">3) + (j &lt;&lt; 4) + (k &lt;&lt; 5) == a[index] and i*3</span>+j*4+k*5 == b[index] and i*j+j*k+k*i == c[index]:</span><br><span class="line">                    <span class="built_in">print</span>(chr(i)+chr(j)+chr(k),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/posts/2e2fc6fb.html"><img class="fill" src="http://img.goubuli.online/blog/20240802000807.png" alt="编码与古典密码"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-08-01T16:04:57.000Z" title="2024/8/2 00:04:57">2024-08-02</time>发表</span><span class="level-item"><time dateTime="2024-08-01T16:08:50.802Z" title="2024/8/2 00:08:50">2024-08-02</time>更新</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/2e2fc6fb.html">编码与古典密码</a></p><div class="content"><h1 id="常见工具"><a href="#常见工具" class="headerlink" title="常见工具"></a>常见工具</h1><h2 id="CyberChef"><a href="#CyberChef" class="headerlink" title="CyberChef"></a>CyberChef</h2><p>地址：<a target="_blank" rel="noopener" href="https://github.com/gchq/CyberChef">https://github.com/gchq/CyberChef</a><br><img src="https://cdn.nlark.com/yuque/0/2024/png/39265092/1722522247354-3d65e5a3-c6b4-4603-be4f-d5f73ca3f762.png#averageHue=%23f9f3e2&amp;clientId=ue0180b9f-426b-4&amp;from=paste&amp;height=741&amp;id=u7f0ee5cd&amp;originHeight=1334&amp;originWidth=2554&amp;originalType=binary&amp;ratio=1.8000000715255737&amp;rotation=0&amp;showTitle=false&amp;size=119271&amp;status=done&amp;style=none&amp;taskId=u12e618c1-a8b9-418a-8094-710f8d5e786&amp;title=&amp;width=1418.8888325073124" alt="image.png"></p>
<h2 id="随波逐流-CTF编码工具"><a href="#随波逐流-CTF编码工具" class="headerlink" title="随波逐流 CTF编码工具"></a>随波逐流 CTF编码工具</h2><p>地址：<a target="_blank" rel="noopener" href="http://1o1o.xyz/">http://1o1o.xyz/</a><br><img src="https://cdn.nlark.com/yuque/0/2024/png/39265092/1722522412728-df4899b5-518e-43d5-b68a-1ca19ed3fdd5.png#averageHue=%23fbfafa&amp;clientId=ue0180b9f-426b-4&amp;from=paste&amp;height=722&amp;id=u18d2d153&amp;originHeight=1300&amp;originWidth=1217&amp;originalType=binary&amp;ratio=1.8000000715255737&amp;rotation=0&amp;showTitle=false&amp;size=125887&amp;status=done&amp;style=none&amp;taskId=u3960818d-175a-4873-b1e2-1be7df74b1d&amp;title=&amp;width=676.1110842448704" alt="image.png"></p>
<h1 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h1><h2 id="ascii码"><a href="#ascii码" class="headerlink" title="ascii码"></a>ascii码</h2><blockquote>
<p>ASCII（发音：，American Standard Code for Information Interchange，美国信息交换标准代码）是基于拉丁字母的一套电脑编码系统。它主要用于显示现代英语，而其扩展版本延伸美国标准信息交换码则可以部分支持其他西欧语言，并等同于国际标准ISO/IEC 646。<br>ASCII 由电报码发展而来。第一版标准发布于1963年 ，1967年经历了一次主要修订[5][6]，最后一次更新则是在1986年，至今为止共定义了128个字符；其中33个字符无法显示（一些终端提供了扩展，使得这些字符可显示为诸如笑脸、扑克牌花式等8-bit符号），且这33个字符多数都已是陈废的控制字符。控制字符的用途主要是用来操控已经处理过的文字。在33个字符之外的是95个可显示的字符。用键盘敲下空白键所产生的空白字符也算1个可显示字符（显示为空白）。</p>
</blockquote>
<p>ascii码对照表：<a target="_blank" rel="noopener" href="https://blog.csdn.net/yueyueniaolzp/article/details/82178954">https://blog.csdn.net/yueyueniaolzp/article/details/82178954</a></p>
<hr>
<h2 id="Hex"><a href="#Hex" class="headerlink" title="Hex"></a>Hex</h2><blockquote>
<p><strong>十六进制</strong>（简写为 hex 或下标 16）是一种基数为 16 的计数系统，是一种逢 16 进 1 的进位制。通常用数字 0、1、2、3、4、5、6、7、8、9 和字母 A、B、C、D、E、F（a、b、c、d、e、f）表示，其中: A~F 表示 10~15，这些称作十六进制数字。</p>
</blockquote>
<hr>
<h2 id="base64编码"><a href="#base64编码" class="headerlink" title="base64编码"></a>base64编码</h2><blockquote>
<p>基于64个可打印的字符来表示二进制的数据的一种方法。</p>
</blockquote>
<p>在使用base64时，需要先定义一串字符串，ABCD……abcd……1234……+/，以上为base64的索引表，在进行编码后也会出现=，==，这是由于补位的需要出现的。<br>原理：<br>1.将待转换的字符每三个字节分为一组，一个字节占8个bit，共有24bit。<br>2.将24个bit每6个分为一组，共4组<br>3.在每组前加两个0，每组由6个bit变为8个bit，共32bit，即4字节<br>4.根据每个字节的10进制数在开头定义的字符串中找对照。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/39265092/1722526340027-cd8821df-b1ba-4c59-b8fb-cf9b08f40512.png#averageHue=%23fbeeee&amp;clientId=ue0180b9f-426b-4&amp;from=paste&amp;height=81&amp;id=u5f44563c&amp;originHeight=145&amp;originWidth=1039&amp;originalType=binary&amp;ratio=1.8000000715255737&amp;rotation=0&amp;showTitle=false&amp;size=11083&amp;status=done&amp;style=none&amp;taskId=ubf4a6190-9123-4ffc-90d0-82c2ad5a96b&amp;title=&amp;width=577.2221992854728" alt="image.png"><br>如图，对ABC进行编码时，先将其转为ascii码，分别为65，66，67，再更换为二进制为01000001，01000010，01000011.将其分为4组后在前面加上00，为00010000，00010111，00001001，00000011 。转为索引就是16，20，9，3，在开头的字符串中进行索引得到QUJD。</p>
<p>以上为满足分为3个字节时，不满足3个字节时<br><img src="https://cdn.nlark.com/yuque/0/2024/png/39265092/1722526996879-0e819f43-7211-4930-b395-650d066cd3f6.png#averageHue=%23fbf1f0&amp;clientId=ue0180b9f-426b-4&amp;from=paste&amp;height=192&amp;id=u506569be&amp;originHeight=345&amp;originWidth=1039&amp;originalType=binary&amp;ratio=1.8000000715255737&amp;rotation=0&amp;showTitle=false&amp;size=23031&amp;status=done&amp;style=none&amp;taskId=ud0af45d2-1650-4b19-bcbf-3029314946b&amp;title=&amp;width=577.2221992854728" alt="image.png"><br>以一个字节为例，当缺少两个字节时，第二组缺少2位，所以对其补上0，会得到2个base编码，而后两组没有数据，所以用=补上，这也就是base64由64个字符组成，最后会出现“=”号的原因。</p>
<hr>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-06-05T12:04:10.000Z" title="2024/6/5 20:04:10">2024-06-05</time>发表</span><span class="level-item"><time dateTime="2025-05-27T14:53:09.777Z" title="2025/5/27 22:53:09">2025-05-27</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Writeup/">Writeup</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/3814da5f.html">LitCTF2024</a></p><div class="content"><p>[toc]</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="little-fermat"><a href="#little-fermat" class="headerlink" title="little_fermat"></a>little_fermat</h2><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,gen_x</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = nextprime(p)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">x = gen_x(p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(<span class="number">666666</span>, x, p) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">m = m ^ x</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>题目描述：</p>
<p>Do you know fermat?</p>
<p>解题思路：</p>
<p>根据断言判断为费马小定理</p>
<script type="math/tex; mode=display">
a^{p-1}\equiv 1\ (mod \ p)</script><p>所以x= p-1</p>
<p>根据给出数据解出m后异或即可</p>
<h2 id="little-fermat-plus"><a href="#little-fermat-plus" class="headerlink" title="little_fermat_plus"></a>little_fermat_plus</h2><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,gen_x</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = nextprime(p)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">x = gen_x(p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(<span class="number">666666</span>, x, p) == <span class="number">1</span> ** <span class="number">1024</span></span><br><span class="line"></span><br><span class="line">m = m ^ x</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>题目描述：</p>
<p>caution difference</p>
<p>解题思路：</p>
<p>费马小定理扩展，原本的费马定理长这样</p>
<script type="math/tex; mode=display">
a^{p-1} \equiv 1 \ (mod\ p)</script><p>在对两边取1024次方后长这样</p>
<script type="math/tex; mode=display">
a^{1024*（p-1）}\equiv 1^{1024}\ (mod\ p)</script><p>所以根据断言，x = 1024*（p-1）</p>
<p>求出m后异或x即可</p>
<h2 id="common-primes"><a href="#common-primes" class="headerlink" title="common_primes"></a>common_primes</h2><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">q2 = getPrime(<span class="number">512</span>)</span><br><span class="line">n1 = p * q1</span><br><span class="line">n2 = p * q2</span><br><span class="line">c1 = <span class="built_in">pow</span>(m, e, n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m, e, n2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n1 = <span class="subst">&#123;n1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n2 = <span class="subst">&#123;n2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1 = <span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2 = <span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>题目描述：</p>
<p>OK,it’s your common primes</p>
<p>解题思路：</p>
<script type="math/tex; mode=display">
gcd(n1,n2) = p</script><h2 id="common-primes-plus"><a href="#common-primes-plus" class="headerlink" title="common_primes_plus"></a>common_primes_plus</h2><p>题目描述：</p>
<p>It’s not hard,trust me</p>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,a,b,c,d</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> a*c == b*d + <span class="number">1</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">q2 = getPrime(<span class="number">512</span>)</span><br><span class="line">n1 = p * q1</span><br><span class="line">n2 = p * q2</span><br><span class="line"></span><br><span class="line">hint1 = a * n1 + b * n2</span><br><span class="line">hint2 = c * n1 + d * n2</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n1 = <span class="subst">&#123;n1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint1 = <span class="subst">&#123;hint1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint2 = <span class="subst">&#123;hint2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>解题思路：</p>
<p>根据定理，由于a,b,c,d互素，ac-bd=1。所以</p>
<script type="math/tex; mode=display">
gcd(hint1,hint2) = gcd(n1,n2) = p</script><p>得到p后常规rsa</p>
<h2 id="CRT"><a href="#CRT" class="headerlink" title="CRT"></a>CRT</h2><p>题目描述：</p>
<p>有物不知其数，三三数之剩二，五五数之剩三，七七数之剩二。问物几何？</p>
<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = 10</span><br><span class="line"></span><br><span class="line">n_list = []</span><br><span class="line">c_list = []</span><br><span class="line">for i in range(10):</span><br><span class="line">    p = getPrime(1024)</span><br><span class="line">    q = getPrime(1024)</span><br><span class="line">    n = p * q</span><br><span class="line">    c = pow(m,e,n)</span><br><span class="line">    n_list.append(n)</span><br><span class="line">    c_list.append(c)</span><br><span class="line"></span><br><span class="line">print(f&quot;n_list = &#123;n_list&#125;&quot;)</span><br><span class="line">print(f&quot;c_list = &#123;c_list&#125;&quot;)</span><br></pre></td></tr></table></figure>
<p>解题思路：</p>
<p>常规CRT脚本</p>
<h2 id="CRT-plus"><a href="#CRT-plus" class="headerlink" title="CRT_plus"></a>CRT_plus</h2><p>题目描述：</p>
<p>也许要在老祖宗留下来的基础上改变一下</p>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">e = <span class="number">5</span></span><br><span class="line">A = [random.randint(<span class="number">1</span>, <span class="number">128</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(e)]</span><br><span class="line">B = [random.randint(<span class="number">1</span>, <span class="number">1024</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(e)]</span><br><span class="line"></span><br><span class="line">C = []</span><br><span class="line">N = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    c = <span class="built_in">pow</span>(A[i] * m + B[i], e, n)</span><br><span class="line">    N.append(n)</span><br><span class="line">    C.append(c)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;A = <span class="subst">&#123;A&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;B = <span class="subst">&#123;B&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;C = <span class="subst">&#123;C&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;N = <span class="subst">&#123;N&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>解题思路：</p>
<h2 id="smell-e"><a href="#smell-e" class="headerlink" title="smell_e"></a>smell_e</h2><p>题目描述：</p>
<p>I spilt the flag into several blocks,can you solve the problem?</p>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span>  gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line">n = ……</span><br><span class="line">c_list = [……]</span><br><span class="line">e=<span class="number">3</span></span><br><span class="line">flag= <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c_list:</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        res = iroot(i+k*n,e)  <span class="comment">#c+k*n 开3次方根 能开3次方即可</span></span><br><span class="line">        <span class="comment">#print(res)</span></span><br><span class="line">        <span class="comment">#res = (mpz(13040004482819713819817340524563023159919305047824600478799740488797710355579494486728991357), True)</span></span><br><span class="line">        <span class="keyword">if</span>(res[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">            flag += libnum.n2s(<span class="built_in">int</span>(res[<span class="number">0</span>]))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        k=k+<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>解题思路：</p>
<p>小e，直接开方即可</p>
<h2 id="smell-e-plus"><a href="#smell-e-plus" class="headerlink" title="smell_e_plus"></a>smell_e_plus</h2><p>题目描述：</p>
<p>You need to change your mind</p>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">e = random.randint(<span class="number">1000</span>,<span class="number">2000</span>)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">c_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> flag:</span><br><span class="line">    c_list.append(<span class="built_in">pow</span>(<span class="built_in">ord</span>(m),e,n))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c_list = <span class="subst">&#123;c_list&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>解题思路：</p>
<p>首先确定flag的开头为L，已知e的范围，在遍历e的情况下对“L”进行加密，得到e的值。随后对每个字符都进行爆破，依次得到flag的每个字符。</p>
<h2 id="EasyRSA"><a href="#EasyRSA" class="headerlink" title="EasyRSA"></a>EasyRSA</h2><p>题目描述：</p>
<p>怎么说呢，就……真的挺简单的</p>
<p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p=getPrime(<span class="number">256</span>)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">n=p**<span class="number">4</span></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>
<p>解题思路：</p>
<p>n为p的4次方，对n直接开方得到p，$phi = p^4-p^3$ 解得m后，发现为fake flag，并给出了hint。多次尝试发现hint为q，与上一步p相乘得到n，求解c2</p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/page/0/">上一页</a></div><div class="pagination-next"><a href="/page/2/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li></ul></nav></div><!--!--><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">g0ubu1i的博客</a><p class="is-size-7"><span>&copy; 2025 g0ubu1i</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><!--!--><script data-pjax src="/js/main.js" defer></script><!--!--></body></html>